<h2 id="local-errors-requireerrors"><code>local errors = require'errors'</code></h2>
<p>This is an API that adds structured exceptions to Lua. Exceptions, like coroutines are not used very frequently in Lua because they solve cross-cutting concerns(*) that don’t appear very often in code. But when they do appear, these devices are invaluable code decluttering tools.</p>
<p>Structured exceptions are an enhancement over string exceptions that enable <em>selective catching</em> and allow <em>providing a context</em> for the failure to help with recovery or logging.</p>
<blockquote>
<p>(*) Coroutines address the problem of inversion-of-control head-on. Exceptions address the problem of recoverable failure head-on, so they’re most useful in network I/O contexts.</p>
</blockquote>
<h2 id="api">API</h2>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>errors.error</code></td>
<td style="text-align: left;">base class for errors</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>errors.errortype([classname], [super]) -&gt; eclass</code></td>
<td style="text-align: left;">create an error class</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>eclass(...) -&gt; e</code></td>
<td style="text-align: left;">create an error object</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>errors.new(classname, [e], ... | e) -&gt; e</code></td>
<td style="text-align: left;">create/wrap/pass-through an error object</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>errors.is(v[, classes]) -&gt; t|f</code></td>
<td style="text-align: left;">check an error object type</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>errors.raise(classname,... | e)</code></td>
<td style="text-align: left;">(create and) raise an error</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>errors.catch(classes, f, ...) -&gt; t,... | f,e</code></td>
<td style="text-align: left;">pcall <code>f</code> and catch errors</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>errors.pcall(f, ...) -&gt; ...</code></td>
<td style="text-align: left;">pcall that stores traceback in <code>e.traceback</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>errors.check(v, ...) -&gt; v | raise(...)</code></td>
<td style="text-align: left;">assert with specifying an error class</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>errors.protect(classes, f) -&gt; protected_f</code></td>
<td style="text-align: left;">turn raising <code>f</code> into a <code>nil,e</code> function</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>eclass:__call(...) -&gt; e</code></td>
<td style="text-align: left;">error class constructor</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>eclass:__tostring() -&gt; s</code></td>
<td style="text-align: left;">to make <code>error(e)</code> work</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>e.message</code></td>
<td style="text-align: left;">formatted error message</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>e.traceback</code></td>
<td style="text-align: left;">traceback at error site</td>
</tr>
</tbody>
</table>
<p>In the API <code>classes</code> can be given as <code>'classname1 ...'</code> or <code>{class1-&gt;true}</code>. When in table form, you must include all the superclasses in the table as they are not added automatically!</p>
