<h1 id="page_setup">The Worksheet Class (Page Setup)</h1>
<p>Page set-up methods affect the way that a worksheet looks when it is printed. They control features such as paper size, orientation, page headers and margins.</p>
<p>These methods are really just standard <code class="interpreted-text" role="ref">worksheet &lt;worksheet&gt;</code> methods. They are documented separately for the sake of clarity.</p>
<h2 id="worksheetset_landscape">worksheet:set_landscape()</h2>
<div class="function">
<p>set_landscape()</p>
<p>Set the page orientation as landscape.</p>
</div>
<p>This method is used to set the orientation of a worksheet's printed page to landscape:</p>
<pre><code> worksheet:set_landscape()</code></pre>
<h2 id="worksheetset_portrait">worksheet:set_portrait()</h2>
<div class="function">
<p>set_portrait()</p>
<p>Set the page orientation as portrait.</p>
</div>
<p>This method is used to set the orientation of a worksheet's printed page to portrait. The default worksheet orientation is portrait, so you won't generally need to call this method:</p>
<pre><code> worksheet:set_portrait()</code></pre>
<h2 id="worksheetset_page_view">worksheet:set_page_view()</h2>
<div class="function">
<p>set_page_view()</p>
<p>Set the page view mode.</p>
</div>
<p>This method is used to display the worksheet in "Page View/Layout" mode:</p>
<pre><code> worksheet:set_page_view()</code></pre>
<h2 id="worksheetset_paper">worksheet:set_paper()</h2>
<div class="function">
<p>set_paper(index)</p>
<p>Set the paper type.</p>
<dl>
<dt>param index</dt>
<dd><p>The Excel paper format index.</p>
</dd>
</dl>
</div>
<p>This method is used to set the paper format for the printed output of a worksheet: The following paper styles are available:</p>
<table style="width:71%;">
<colgroup>
<col style="width: 11%" />
<col style="width: 31%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Index</th>
<th style="text-align: left;">Paper format</th>
<th style="text-align: left;">Paper size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">Printer default</td>
<td style="text-align: left;">Printer default</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Letter</td>
<td style="text-align: left;">8 1/2 x 11 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Letter Small</td>
<td style="text-align: left;">8 1/2 x 11 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Tabloid</td>
<td style="text-align: left;">11 x 17 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Ledger</td>
<td style="text-align: left;">17 x 11 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Legal</td>
<td style="text-align: left;">8 1/2 x 14 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Statement</td>
<td style="text-align: left;">5 1/2 x 8 1/2 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Executive</td>
<td style="text-align: left;">7 1/4 x 10 1/2 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">A3</td>
<td style="text-align: left;">297 x 420 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">A4</td>
<td style="text-align: left;">210 x 297 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: left;">A4 Small</td>
<td style="text-align: left;">210 x 297 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: left;">A5</td>
<td style="text-align: left;">148 x 210 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: left;">B4</td>
<td style="text-align: left;">250 x 354 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: left;">B5</td>
<td style="text-align: left;">182 x 257 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: left;">Folio</td>
<td style="text-align: left;">8 1/2 x 13 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: left;">Quarto</td>
<td style="text-align: left;">215 x 275 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: left;">---</td>
<td style="text-align: left;">10x14 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">17</td>
<td style="text-align: left;">---</td>
<td style="text-align: left;">11x17 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: left;">Note</td>
<td style="text-align: left;">8 1/2 x 11 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: left;">Envelope 9</td>
<td style="text-align: left;">3 7/8 x 8 7/8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: left;">Envelope 10</td>
<td style="text-align: left;">4 1/8 x 9 1/2</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Envelope 11</td>
<td style="text-align: left;">4 1/2 x 10 3/8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">22</td>
<td style="text-align: left;">Envelope 12</td>
<td style="text-align: left;">4 3/4 x 11</td>
</tr>
<tr class="even">
<td style="text-align: left;">23</td>
<td style="text-align: left;">Envelope 14</td>
<td style="text-align: left;">5 x 11 1/2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">24</td>
<td style="text-align: left;">C size sheet</td>
<td style="text-align: left;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">25</td>
<td style="text-align: left;">D size sheet</td>
<td style="text-align: left;">---</td>
</tr>
<tr class="odd">
<td style="text-align: left;">26</td>
<td style="text-align: left;">E size sheet</td>
<td style="text-align: left;">---</td>
</tr>
<tr class="even">
<td style="text-align: left;">27</td>
<td style="text-align: left;">Envelope DL</td>
<td style="text-align: left;">110 x 220 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">28</td>
<td style="text-align: left;">Envelope C3</td>
<td style="text-align: left;">324 x 458 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">29</td>
<td style="text-align: left;">Envelope C4</td>
<td style="text-align: left;">229 x 324 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">30</td>
<td style="text-align: left;">Envelope C5</td>
<td style="text-align: left;">162 x 229 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">31</td>
<td style="text-align: left;">Envelope C6</td>
<td style="text-align: left;">114 x 162 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">32</td>
<td style="text-align: left;">Envelope C65</td>
<td style="text-align: left;">114 x 229 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">33</td>
<td style="text-align: left;">Envelope B4</td>
<td style="text-align: left;">250 x 353 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">34</td>
<td style="text-align: left;">Envelope B5</td>
<td style="text-align: left;">176 x 250 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">35</td>
<td style="text-align: left;">Envelope B6</td>
<td style="text-align: left;">176 x 125 mm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">36</td>
<td style="text-align: left;">Envelope</td>
<td style="text-align: left;">110 x 230 mm</td>
</tr>
<tr class="even">
<td style="text-align: left;">37</td>
<td style="text-align: left;">Monarch</td>
<td style="text-align: left;">3.875 x 7.5 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">38</td>
<td style="text-align: left;">Envelope</td>
<td style="text-align: left;">3 5/8 x 6 1/2 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">39</td>
<td style="text-align: left;">Fanfold</td>
<td style="text-align: left;">14 7/8 x 11 in</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40</td>
<td style="text-align: left;">German Std Fanfold</td>
<td style="text-align: left;">8 1/2 x 12 in</td>
</tr>
<tr class="even">
<td style="text-align: left;">41</td>
<td style="text-align: left;">German Legal Fanfold</td>
<td style="text-align: left;">8 1/2 x 13 in</td>
</tr>
</tbody>
</table>
<p>Note, it is likely that not all of these paper types will be available to the end user since it will depend on the paper formats that the user's printer supports. Therefore, it is best to stick to standard paper types:</p>
<pre><code> worksheet:set_paper(1) -- US Letter
 worksheet:set_paper(9) -- A4</code></pre>
<p>If you do not specify a paper type the worksheet will print using the printer's default paper style.</p>
<h2 id="worksheetcenter_horizontally">worksheet:center_horizontally()</h2>
<div class="function">
<p>center_horizontally()</p>
<p>Center the printed page horizontally.</p>
</div>
<p>Center the worksheet data horizontally between the margins on the printed page:</p>
<pre><code> worksheet:center_horizontally()</code></pre>
<h2 id="worksheetcenter_vertically">worksheet:center_vertically()</h2>
<div class="function">
<p>center_vertically()</p>
<p>Center the printed page vertically.</p>
</div>
<p>Center the worksheet data vertically between the margins on the printed page:</p>
<pre><code> worksheet:center_vertically()</code></pre>
<h2 id="worksheetset_margins">worksheet:set_margins()</h2>
<div class="function">
<p>set_margins([left=0.7,] right=0.7,] top=0.75,] bottom=0.75]]])</p>
<p>Set the worksheet margins for the printed page.</p>
<dl>
<dt>param left</dt>
<dd><p>Left margin in inches. Default 0.7.</p>
</dd>
<dt>param right</dt>
<dd><p>Right margin in inches. Default 0.7.</p>
</dd>
<dt>param top</dt>
<dd><p>Top margin in inches. Default 0.75.</p>
</dd>
<dt>param bottom</dt>
<dd><p>Bottom margin in inches. Default 0.75.</p>
</dd>
</dl>
</div>
<p>The <code>set_margins()</code> method is used to set the margins of the worksheet when it is printed. The units are in inches. All parameters are optional and have default values corresponding to the default Excel values.</p>
<h2 id="worksheetset_header">worksheet:set_header()</h2>
<div class="function">
<p>set_header([header="",] margin=0.3]])</p>
<p>Set the printed page header caption and optional margin.</p>
<dl>
<dt>param header</dt>
<dd><p>Header string with Excel control characters.</p>
</dd>
<dt>param margin</dt>
<dd><p>Header margin in inches. Default 0.3.</p>
</dd>
</dl>
</div>
<p>Headers and footers are generated using a string which is a combination of plain text and control characters.</p>
<p>The available control character are:</p>
<table style="width:81%;">
<colgroup>
<col style="width: 25%" />
<col style="width: 22%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Control</th>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">&amp;L</td>
<td style="text-align: left;">Justification</td>
<td style="text-align: left;">Left</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;C</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Center</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;R</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Right</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;P</td>
<td style="text-align: left;">Information</td>
<td style="text-align: left;">Page number</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;N</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Total number of pages</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;D</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Date</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;T</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Time</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;F</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">File name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;A</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Worksheet name</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;Z</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Workbook path</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;fontsize</td>
<td style="text-align: left;">Font</td>
<td style="text-align: left;">Font size</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;"font,style"</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Font name and style</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;U</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Single underline</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;E</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Double underline</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;S</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Strikethrough</td>
</tr>
<tr class="even">
<td style="text-align: left;">&amp;X</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Superscript</td>
</tr>
<tr class="odd">
<td style="text-align: left;">&amp;Y</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Subscript</td>
</tr>
</tbody>
</table>
<p>Text in headers and footers can be justified (aligned) to the left, center and right by prefixing the text with the control characters <code>&amp;L</code>, <code>&amp;C</code> and <code>&amp;R</code>.</p>
<p>For example (with ASCII art representation of the results):</p>
<pre><code> worksheet:set_header(&quot;&amp;LHello&quot;)

     ---------------------------------------------------------------
    |                                                               |
    | Hello                                                         |
    |                                                               |


 $worksheet-&gt;set_header(&quot;&amp;CHello&quot;);

     ---------------------------------------------------------------
    |                                                               |
    |                          Hello                                |
    |                                                               |


 $worksheet-&gt;set_header(&quot;&amp;RHello&quot;);

     ---------------------------------------------------------------
    |                                                               |
    |                                                         Hello |
    |                                                               |</code></pre>
<p>For simple text, if you do not specify any justification the text will be centred. However, you must prefix the text with <code>&amp;C</code> if you specify a font name or any other formatting:</p>
<pre><code> worksheet:set_header(&quot;Hello&quot;)

     ---------------------------------------------------------------
    |                                                               |
    |                          Hello                                |
    |                                                               |</code></pre>
<p>You can have text in each of the justification regions:</p>
<pre><code> worksheet:set_header(&quot;&amp;LCiao&amp;CBello&amp;RCielo&quot;)

     ---------------------------------------------------------------
    |                                                               |
    | Ciao                     Bello                          Cielo |
    |                                                               |</code></pre>
<p>The information control characters act as variables that Excel will update as the workbook or worksheet changes. Times and dates are in the users default format:</p>
<pre><code> worksheet:set_header(&quot;&amp;CPage &amp;P of &amp;N&quot;)

     ---------------------------------------------------------------
    |                                                               |
    |                        Page 1 of 6                            |
    |                                                               |

 worksheet:set_header(&quot;&amp;CUpdated at &amp;T&quot;)

     ---------------------------------------------------------------
    |                                                               |
    |                    Updated at 12:30 PM                        |
    |                                                               |</code></pre>
<p>You can specify the font size of a section of the text by prefixing it with the control character <code>&amp;n</code> where <code>n</code> is the font size:</p>
<pre><code> worksheet1:set_header(&quot;&amp;C&amp;30Hello Big&quot;)
 worksheet2:set_header(&quot;&amp;C&amp;10Hello Small&quot;)</code></pre>
<p>You can specify the font of a section of the text by prefixing it with the control sequence <code>&amp;"font,style"</code> where <code>fontname</code> is a font name such as "Courier New" or "Times New Roman" and <code>style</code> is one of the standard Windows font descriptions: "Regular", "Italic", "Bold" or "Bold Italic":</p>
<pre><code> worksheet1:set_header(&#39;&amp;C&amp;&quot;Courier New,Italic&quot;Hello&#39;)
 worksheet2:set_header(&#39;&amp;C&amp;&quot;Courier New,Bold Italic&quot;Hello&#39;)
 worksheet3:set_header(&#39;&amp;C&amp;&quot;Times New Roman,Regular&quot;Hello&#39;)</code></pre>
<p>It is possible to combine all of these features together to create sophisticated headers and footers. As an aid to setting up complicated headers and footers you can record a page set-up as a macro in Excel and look at the format strings that VBA produces. Remember however that VBA uses two double quotes <code>""</code> to indicate a single double quote. For the last example above the equivalent VBA code looks like this:</p>
<pre><code> .LeftHeader = &quot;&quot;
 .CenterHeader = &quot;&amp;&quot;&quot;Times New Roman,Regular&quot;&quot;Hello&quot;
 .RightHeader = &quot;&quot;</code></pre>
<p>To include a single literal ampersand <code>&amp;</code> in a header or footer you should use a double ampersand <code>&amp;&amp;</code>:</p>
<pre><code> worksheet1:set_header(&quot;&amp;CCuriouser &amp;&amp; Curiouser - Attorneys at Law&quot;)</code></pre>
<p>As stated above the margin parameter is optional. As with the other margins the value should be in inches. The default header and footer margin is 0.3 inch. The header and footer margin size can be set as follows:</p>
<pre><code> worksheet:set_header(&quot;&amp;CHello&quot;, 0.75)</code></pre>
<p>The header and footer margins are independent of the top and bottom margins.</p>
<p>Note, the header or footer string must be less than 255 characters. Strings longer than this will not be written and an exception will be thrown.</p>
<p>See also <code class="interpreted-text" role="ref">ex_headers_footers</code>.</p>
<h2 id="worksheetset_footer">worksheet:set_footer()</h2>
<div class="function">
<p>set_footer([footer="",] margin=0.3]])</p>
<p>Set the printed page footer caption and optional margin.</p>
<dl>
<dt>param footer</dt>
<dd><p>Footer string with Excel control characters.</p>
</dd>
<dt>param margin</dt>
<dd><p>Footer margin in inches. Default 0.3.</p>
</dd>
</dl>
</div>
<p>The syntax of the <code>set_footer()</code> method is the same as <code class="interpreted-text" role="func">set_header</code>.</p>
<h2 id="worksheetrepeat_rows">worksheet:repeat_rows()</h2>
<div class="function">
<p>repeat_rows(first_row[, last_row])</p>
<p>Set the number of rows to repeat at the top of each printed page.</p>
<dl>
<dt>param first_row</dt>
<dd><p>First row of repeat range.</p>
</dd>
<dt>param last_row</dt>
<dd><p>Last row of repeat range. Optional.</p>
</dd>
</dl>
</div>
<p>For large Excel documents it is often desirable to have the first row or rows of the worksheet print out at the top of each page.</p>
<p>This can be achieved by using the <code>repeat_rows()</code> method. The parameters <code>first_row</code> and <code>last_row</code> are zero based. The <code>last_row</code> parameter is optional if you only wish to specify one row:</p>
<pre><code> worksheet1:repeat_rows(0)    -- Repeat the first row.
 worksheet2:repeat_rows(0, 1) -- Repeat the first two rows.</code></pre>
<h2 id="worksheetrepeat_columns">worksheet:repeat_columns()</h2>
<div class="function">
<p>repeat_columns(first_col[, last_col])</p>
<p>Set the columns to repeat at the left hand side of each printed page.</p>
<dl>
<dt>param first_col</dt>
<dd><p>First column of repeat range.</p>
</dd>
<dt>param last_col</dt>
<dd><p>Last column of repeat range. Optional.</p>
</dd>
</dl>
</div>
<p>For large Excel documents it is often desirable to have the first column or columns of the worksheet print out at the left hand side of each page.</p>
<p>This can be achieved by using the <code>repeat_columns()</code> method. The parameters <code>first_column</code> and <code>last_column</code> are zero based. The <code>last_column</code> parameter is optional if you only wish to specify one column. You can also specify the columns using A1 column notation, see <code class="interpreted-text" role="ref">cell_notation</code> for more details.:</p>
<pre><code> worksheet1.repeat_columns(0)     -- Repeat the first column.
 worksheet2.repeat_columns(0, 1)  -- Repeat the first two columns.
 worksheet3.repeat_columns(&quot;A:A&quot;) -- Repeat the first column.
 worksheet4.repeat_columns(&quot;A:B&quot;) -- Repeat the first two columns.</code></pre>
<h2 id="worksheethide_gridlines">worksheet:hide_gridlines()</h2>
<div class="function">
<p>hide_gridlines([option=1])</p>
<p>Set the option to hide gridlines on the screen and the printed page.</p>
<dl>
<dt>param option</dt>
<dd><p>Hide gridline options. See below.</p>
</dd>
</dl>
</div>
<p>This method is used to hide the gridlines on the screen and printed page. Gridlines are the lines that divide the cells on a worksheet. Screen and printed gridlines are turned on by default in an Excel worksheet.</p>
<p>If you have defined your own cell borders you may wish to hide the default gridlines:</p>
<pre><code> worksheet:hide_gridlines()</code></pre>
<p>The following values of <code>option</code> are valid:</p>
<ol type="1">
<li>Don't hide gridlines.</li>
<li>Hide printed gridlines only.</li>
<li>Hide screen and printed gridlines.</li>
</ol>
<p>If you don't supply an argument the default option is 1, i.e.Â only the printed gridlines are hidden.</p>
<h2 id="worksheetprint_row_col_headers">worksheet:print_row_col_headers()</h2>
<div class="function">
<p>print_row_col_headers()</p>
<p>Set the option to print the row and column headers on the printed page.</p>
</div>
<p>When you print a worksheet from Excel you get the data selected in the print area. By default the Excel row and column headers (the row numbers on the left and the column letters at the top) aren't printed.</p>
<p>The <code>print_row_col_headers()</code> method sets the printer option to print these headers:</p>
<pre><code> worksheet:print_row_col_headers()</code></pre>
<h2 id="worksheetprint_area">worksheet:print_area()</h2>
<div class="function">
<p>print_area(first_row, first_col, last_row, last_col)</p>
<p>Set the print area in the current worksheet.</p>
<dl>
<dt>param first_row</dt>
<dd><p>The first row of the range. (All zero indexed.)</p>
</dd>
<dt>param first_col</dt>
<dd><p>The first column of the range.</p>
</dd>
<dt>param last_row</dt>
<dd><p>The last row of the range.</p>
</dd>
<dt>param last_col</dt>
<dd><p>The last col of the range.</p>
</dd>
</dl>
</div>
<p>This method is used to specify the area of the worksheet that will be printed.</p>
<p>All four parameters must be specified. You can also use A1 notation, see <code class="interpreted-text" role="ref">cell_notation</code>:</p>
<pre><code> worksheet1.print_area(&quot;A1:H20&quot;)    -- Cells A1 to H20.
 worksheet2.print_area(0, 0, 19, 7) -- The same as above.
 worksheet3.print_area(&quot;A:H&quot;)       -- Columns A to H if rows have data.</code></pre>
<h2 id="worksheetprint_across">worksheet:print_across()</h2>
<div class="function">
<p>print_across()</p>
<p>Set the order in which pages are printed.</p>
</div>
<p>The <code>print_across</code> method is used to change the default print direction. This is referred to by Excel as the sheet "page order":</p>
<pre><code> worksheet:print_across()</code></pre>
<p>The default page order is shown below for a worksheet that extends over 4 pages. The order is called "down then across":</p>
<pre><code> [1] [3]
 [2] [4]</code></pre>
<p>However, by using the <code>print_across</code> method the print order will be changed to "across then down":</p>
<pre><code> [1] [2]
 [3] [4]</code></pre>
<h2 id="worksheetfit_to_pages">worksheet:fit_to_pages()</h2>
<div class="function">
<p>fit_to_pages(width, height)</p>
<p>Fit the printed area to a specific number of pages both vertically and horizontally.</p>
<dl>
<dt>param width</dt>
<dd><p>Number of pages horizontally.</p>
</dd>
<dt>param height</dt>
<dd><p>Number of pages vertically.</p>
</dd>
</dl>
</div>
<p>The <code>fit_to_pages()</code> method is used to fit the printed area to a specific number of pages both vertically and horizontally. If the printed area exceeds the specified number of pages it will be scaled down to fit. This ensures that the printed area will always appear on the specified number of pages even if the page size or margins change:</p>
<pre><code> worksheet1.fit_to_pages(1, 1) -- Fit to 1x1 pages.
 worksheet2.fit_to_pages(2, 1) -- Fit to 2x1 pages.
 worksheet3.fit_to_pages(1, 2) -- Fit to 1x2 pages.</code></pre>
<p>The print area can be defined using the <code>print_area()</code> method as described above.</p>
<p>A common requirement is to fit the printed output to <code>n</code> pages wide but have the height be as long as necessary. To achieve this set the <code>height</code> to zero:</p>
<pre><code> worksheet1.fit_to_pages(1, 0) -- 1 page wide and as long as necessary.</code></pre>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>Although it is valid to use both <code class="interpreted-text" role="func">fit_to_pages()</code> and <code class="interpreted-text" role="func">set_print_scale()</code> on the same worksheet Excel only one of these options to be active at a time. The last method call made will set the active option.</p>
</div>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>The <code class="interpreted-text" role="func">fit_to_pages()</code> will override any manual page breaks that are defined in the worksheet.</p>
</div>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>When using <code class="interpreted-text" role="func">fit_to_pages()</code> it may also be required to set the printer paper size using <code class="interpreted-text" role="func">set_paper()</code> or else Excel will default to "US Letter".</p>
</div>
<h2 id="worksheetset_start_page">worksheet:set_start_page()</h2>
<div class="function">
<p>set_start_page()</p>
<p>Set the start page number when printing.</p>
<dl>
<dt>param start_page</dt>
<dd><p>Starting page number.</p>
</dd>
</dl>
</div>
<p>The <code>set_start_page()</code> method is used to set the number of the starting page when the worksheet is printed out:</p>
<pre><code> -- Start print from page 2.
 worksheet:set_start_page(2)</code></pre>
<h2 id="worksheetset_print_scale">worksheet:set_print_scale()</h2>
<div class="function">
<p>set_print_scale()</p>
<p>Set the scale factor for the printed page.</p>
<dl>
<dt>param scale</dt>
<dd><p>Print scale of worksheet to be printed.</p>
</dd>
</dl>
</div>
<p>Set the scale factor of the printed page. Scale factors in the range <code>10 &lt;= $scale &lt;= 400</code> are valid:</p>
<pre><code> worksheet1:set_print_scale(50)
 worksheet2:set_print_scale(75)
 worksheet3:set_print_scale(300)
 worksheet4:set_print_scale(400)</code></pre>
<p>The default scale factor is 100. Note, <code>set_print_scale()</code> does not affect the scale of the visible page in Excel. For that you should use <code class="interpreted-text" role="func">set_zoom()</code>.</p>
<p>Note also that although it is valid to use both <code>fit_to_pages()</code> and <code>set_print_scale()</code> on the same worksheet Excel only allows one of these options to be active at a time. The last method call made will set the active option.</p>
<h2 id="worksheetset_h_pagebreaks">worksheet:set_h_pagebreaks()</h2>
<div class="function">
<p>set_h_pagebreaks(breaks)</p>
<p>Set the horizontal page breaks on a worksheet.</p>
<dl>
<dt>param breaks</dt>
<dd><p>Table of page break rows.</p>
</dd>
</dl>
</div>
<p>The <code>set_h_pagebreaks()</code> method adds horizontal page breaks to a worksheet. A page break causes all the data that follows it to be printed on the next page. Horizontal page breaks act between rows.</p>
<p>The <code>set_h_pagebreaks()</code> method takes a table of one or more page breaks:</p>
<pre><code> worksheet1:set_v_pagebreaks({20})
 worksheet2:set_v_pagebreaks({20, 40, 60, 80, 100})</code></pre>
<p>To create a page break between rows 20 and 21 you must specify the break at row 21. However in zero index notation this is actually row 20. So you can pretend for a small while that you are using 1 index notation:</p>
<pre><code> worksheet:set_h_pagebreaks({20}) -- Break between row 20 and 21.</code></pre>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>Note: If you specify the "fit to page" option via the <code>fit_to_pages()</code> method it will override all manual page breaks.</p>
</div>
<p>There is a silent limitation of 1023 horizontal page breaks per worksheet in line with an Excel internal limitation.</p>
<h2 id="worksheetset_v_pagebreaks">worksheet:set_v_pagebreaks()</h2>
<div class="function">
<p>set_v_pagebreaks(breaks)</p>
<p>Set the vertical page breaks on a worksheet.</p>
<dl>
<dt>param breaks</dt>
<dd><p>Table of page break columns.</p>
</dd>
</dl>
</div>
<p>The <code>set_v_pagebreaks()</code> method is the same as the above <code class="interpreted-text" role="func">set_h_pagebreaks()</code> method except it adds page breaks between columns.</p>
